#!/usr/bin/env groovy

library identifier: 'custom-lib@master', retriever: modernSCM(
  [$class: 'GitSCMSource',
   remote: 'https://github.com/hqzhang/sample-web-application.git',
   credentialsId: ''])

   filterLogs.test()

pipeline{
	
       agent any

       /* agent {
                docker {
                image 'maven'
                args '-v $HOME/.m2:/root/.m2'
                }
            }*/
        
        stages{
              stage('maven build'){
                  steps{
               script {
                def z = new org.foo.MavenBuilder()
               z.mavenBuild()}
			/*config('repo_config.yml') { 
			     sh "${mavenBuild()}"  
   			} */
               	     
			 config {
				  sh "${mavenBuild()}"
			  }
			}
                 }	
                 
                 stage ('Check logs') {
                    steps {
                        filterLogs ('WARNING', 1)
                    }
                }
		
           }	       	     	         
}
